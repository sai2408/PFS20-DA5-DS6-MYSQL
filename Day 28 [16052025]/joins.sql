CREATE DATABASE HELLO28;
USE HELLO28;

CREATE TABLE STUDENTS(
	STUDENT_ID INT PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL,
    AGE INT
);
INSERT INTO students VALUES
(1, 'John', 20),
(2, 'Sara', 21),
(3, 'Mike', 22),
(4, 'Lily', 20),
(5, 'Tom', 23);


CREATE TABLE COURSES(
	COURSE_ID INT PRIMARY KEY,
    COURSE_NAME VARCHAR(20) NOT NULL
);
INSERT INTO courses VALUES
(101, 'Mathematics'),
(102, 'Physics'),
(103, 'Biology'),
(104, 'Chemistry');


CREATE TABLE ENROLLMENTS(
	ENROLLMENT_ID INT PRIMARY KEY,
    STUDENT_ID INT,
    COURSE_ID INT,
    FOREIGN KEY (STUDENT_ID) REFERENCES STUDENTS(STUDENT_ID),
	FOREIGN KEY (COURSE_ID) REFERENCES COURSES(COURSE_ID)
);

INSERT INTO enrollments VALUES
(1, 1, 101),
(2, 2, 101),
(3, 2, 102),
(4, 3, 103),
(5, 4, 101);


SELECT * FROM STUDENTS;
SELECT * FROM COURSES;
SELECT * FROM ENROLLMENTS;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
INNER JOIN ENROLLMENTS 
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
INNER JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID;

SELECT COURSES.COURSE_NAME,STUDENTS.NAME
FROM COURSES
INNER JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
INNER JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID;


SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
INNER JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
INNER JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
WHERE COURSES.COURSE_NAME = "PHYSICS";

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
LEFT JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
LEFT JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID;

SELECT COURSES.COURSE_NAME,STUDENTS.NAME
FROM COURSES
LEFT JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
LEFT JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
RIGHT JOIN ENROLLMENTS 
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
RIGHT JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
LEFT JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
LEFT JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
UNION
SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
RIGHT JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
RIGHT JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID;

SELECT S1.NAME,S2.NAME FROM
STUDENTS AS S1,STUDENTS AS S2
WHERE S1.AGE = S2.AGE AND S1.STUDENT_ID != S2.STUDENT_ID;


SELECT COURSES.COURSE_NAME,COUNT(ENROLLMENTS.COURSE_ID)
FROM COURSES
LEFT JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
GROUP BY COURSES.COURSE_NAME;

SELECT STUDENTS.NAME,COUNT(ENROLLMENTS.STUDENT_ID)
FROM STUDENTS
LEFT JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
GROUP BY STUDENTS.NAME;


SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
INNER JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
INNER JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
ORDER BY STUDENTS.NAME;

SELECT STUDENTS.NAME,COURSES.COURSE_NAME
FROM STUDENTS
INNER JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
INNER JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
ORDER BY COURSES.COURSE_NAME;


SELECT COURSES.COURSE_NAME,COUNT(ENROLLMENTS.COURSE_ID) AS TC
FROM COURSES
LEFT JOIN ENROLLMENTS
ON COURSES.COURSE_ID = ENROLLMENTS.COURSE_ID
LEFT JOIN STUDENTS
ON ENROLLMENTS.STUDENT_ID = STUDENTS.STUDENT_ID
GROUP BY COURSES.COURSE_NAME
HAVING TC > 1;

SELECT STUDENTS.NAME,COUNT(ENROLLMENTS.STUDENT_ID)
FROM STUDENTS
INNER JOIN ENROLLMENTS
ON STUDENTS.STUDENT_ID = ENROLLMENTS.STUDENT_ID
INNER JOIN COURSES
ON ENROLLMENTS.COURSE_ID = COURSES.COURSE_ID
GROUP BY ENROLLMENTS.STUDENT_ID
HAVING COUNT(ENROLLMENTS.STUDENT_ID) > 1;