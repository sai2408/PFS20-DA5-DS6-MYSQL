CREATE DATABASE HELLO27;
USE HELLO27;

CREATE TABLE EMPDETAILS(
	ID INT PRIMARY KEY,
    NAME VARCHAR(20),
    SALARY INT
);
INSERT INTO EMPDETAILS VALUES
(1,"E1",10000),
(2,"E2",20000),
(3,"E3",30000);


CREATE TABLE MSTATUS(
	ID INT PRIMARY KEY,
    NAME VARCHAR(20),
    STATUSM VARCHAR(10)
);
INSERT INTO MSTATUS VALUES
(1,"E1","MARRIED"),
(2,"E2","MARRIED"),
(4,"E4","UNMARRIED");
SELECT * FROM EMPDETAILS;
SELECT * FROM MSTATUS;

SELECT MSTATUS.ID,MSTATUS.NAME,SALARY,STATUSM
FROM EMPDETAILS 
RIGHT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID;

CREATE TABLE COLOURS(
	C1 VARCHAR(10),
    NAME VARCHAR(20),
    C2 VARCHAR(10)
);
INSERT INTO COLOURS VALUES
("BLUE","JOHN","RED"),
("GREEN","ALEX","BLUE"),
("RED","SIMON","GREEN");
SELECT * FROM COLOURS;

SELECT X.NAME,Y.NAME 
FROM COLOURS AS X,COLOURS AS Y
WHERE X.C1 = Y.C2;

SELECT EMPDETAILS.ID,EMPDETAILS.NAME,SALARY,STATUSM
FROM EMPDETAILS 
LEFT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID
UNION
SELECT EMPDETAILS.ID,EMPDETAILS.NAME,SALARY,STATUSM
FROM EMPDETAILS 
RIGHT JOIN MSTATUS
ON EMPDETAILS.ID = MSTATUS.ID; 


-- EXAMPLES

CREATE TABLE EMPLOYEES(
	EMP_ID INT PRIMARY KEY,
    NAME VARCHAR(20) NOT NULL,
    DEPARTMENT_ID INT,
    SALARY INT
);
INSERT INTO employees (emp_id, name, department_id, salary) VALUES
(101, 'Alice', 1, 50000),
(102, 'Bob', 2, 60000),
(103, 'Charlie', 2, 70000),
(104, 'David', 3, 45000),
(105, 'Eve', NULL, 40000),
(106, 'Frank', 4, 55000),
(107, 'Grace', 2, 62000);
SELECT * FROM EMPLOYEES;


CREATE TABLE DEPARTMENTS(
	DEPARTMENT_ID INT PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(2) NOT NULL
);
ALTER TABLE DEPARTMENTS MODIFY DEPARTMENT_NAME VARCHAR(20);
INSERT INTO departments VALUES
(1, 'HR'),
(2, 'Engineering'),
(3, 'Marketing'),
(4, 'Finance');
SELECT * FROM DEPARTMENTS;


CREATE TABLE PROJECTS(
	PROJECT_ID INT PRIMARY KEY,
    PROJECT_NAME VARCHAR(20) NOT NULL,
    EMP_ID INT
);
INSERT INTO projects (project_id, project_name, emp_id) VALUES
(201, 'Website Redesign', 102),
(202, 'Mobile App', 103),
(203, 'Ad Campaign', 104),
(204, 'Data Migration', 106),
(205, 'Backend Optimization', 107),
(206, 'Product Launch', NULL); 
SELECT * FROM PROJECTS;


SELECT EMP_ID,NAME,EMPLOYEES.DEPARTMENT_ID,SALARY
FROM DEPARTMENTS
RIGHT JOIN EMPLOYEES
ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID;


SELECT *
FROM EMPLOYEES
RIGHT JOIN PROJECTS
ON EMPLOYEES.EMP_ID = PROJECTS.EMP_ID;

SELECT *
FROM DEPARTMENTS
RIGHT JOIN EMPLOYEES
ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID;


SELECT E1.NAME,E2.NAME 
FROM EMPLOYEES AS E1,EMPLOYEES AS E2
WHERE E1.DEPARTMENT_ID=E2.DEPARTMENT_ID AND E1.EMP_ID != E2.EMP_ID;   

SELECT E1.NAME,E2.NAME 
FROM EMPLOYEES AS E1
JOIN EMPLOYEES AS E2
ON E1.DEPARTMENT_ID=E2.DEPARTMENT_ID AND E1.EMP_ID <> E2.EMP_ID;

SELECT * FROM EMPLOYEES;

SELECT E1.NAME,E2.NAME
FROM EMPLOYEES AS E1,EMPLOYEES AS E2
WHERE E1.SALARY > E2.SALARY;

SELECT E1.NAME,E2.NAME
FROM EMPLOYEES AS E1
JOIN EMPLOYEES AS E2
ON E1.SALARY > E2.SALARY;